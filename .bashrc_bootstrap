#!/bin/bash

if curl -V &> /dev/null; then 
    _dlcmd="curl -fsSL"
elif wget -V &> /dev/null; then
    _dlcmd="wget -qO -"
fi

get_micro () {
    echo "Installing micro..."
    if ! [[ -z "${_dlcmd}" ]]; then
        _installer="https://getmic.ro"
        mkdir -p "${HOME}/.local/bin/"
        pushd "${HOME}/.local/bin/"
            bash <(${_dlcmd} "${_installer}")
        popd
    else
        echo "No download method available"
    fi
}

get_bash_completion () {
    echo "Installing bash-completion..."
    if ! [[ -z "${_dlcmd}" ]]; then
        _release="https://github.com/scop/bash-completion/releases/download/2.11/bash-completion-2.11.tar.xz"
        tar -xJf <(${_dlcmd} "${_release}") -C "/tmp" &&
        pushd "/tmp/$(basename ${_release} .tar.xz)" &&
            ./configure &&
            make prefix="${HOME}/.local" &&
            make prefix="${HOME}/.local" install
        popd
        rm -rf "/tmp/$(basename ${_release} .tar.xz)"
    else
        echo "No download method available"
    fi
}

get_starship () {
    echo "Installing starship..."
    if ! [[ -z "${_dlcmd}" ]]; then
        _installer="https://starship.rs/install.sh"
        mkdir -p "${HOME}/.local/bin/"
        sh <(${_dlcmd} "${_installer}") \
            --bin-dir "${HOME}/.local/bin" \
            --yes
    else
        echo "No download method available"
    fi
}

get_fzf () {
    echo "Installing fzf..."
    if ! [[ -z "${_dlcmd}" ]]; then
        _completion="https://raw.githubusercontent.com/junegunn/fzf/master/shell/completion.bash"
        _installer="https://raw.githubusercontent.com/junegunn/fzf/master/install"
        mkdir -p "${HOME}/.local/bin/"
        mkdir -p "${HOME}/.local/shell/fzf"
        ${_dlcmd} "${_completion}" > "${HOME}/.local/shell/fzf/completion.bash"
        ${_dlcmd} "${_installer}" > "${HOME}/.local/install_fzf" &&
        pushd "${HOME}/.local" &&
            bash ./install_fzf \
                --bin \
                --no-update-rc \
                --no-zsh \
                --no-key-bindings
        popd
        rm -f "${HOME}/.local/install_fzf"
    else
        echo "No download method available"
    fi
}
